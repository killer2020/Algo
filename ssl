SSL Communication

Difference between keystore and truststore.

You are going to buy a fire extinguisher for you house,you are worried that someone can sell you
risky product and you say that I am going to buy only fire extinguisher which are approved by below organisation

(FDI corp and Govt of India)

Here you are "client" and the above three corporations are your "truststore", you trust them.



You go to shop he presents you a fire extinguisher verified by these organisations->(TMG corp,DEF corp).
You check if any of this is present in you "trust store".
No!!!! cant trust!!! you reject it.

Here shop is "Server" and (TMG corp,DEF corp) is there "keystore".

You go to another shop they give you fire extinguisher signed by (ABC corp and Govt of India).
You check this in your "truststore"----!!!!! Match (Govt of India) !!!  SSL communication established

And you buy that fire extinguisher as you know "Govt of India" is renowned organisation and anything verified/signed by them is trustworthy.



This is very basic of how SSL communication is established.

Server has a "keystore" with certificates signed by some organisations.

Client has "truststore" with its own trusted certificates.

Client tries to connect to Server.

Server present its certificates and client check if certificates match its certificate in its trust store(public/private key involved,to be explained later).

If yes match!!!! SSL communication is established. 

--------------------------------------------------------------------

What is chain of certificates?

Same scenario:
You are going to buy a fire extinguisher for you house,you are worried that someone can sell you
risky product and you say that I am going to buy only fire extinguisher which are approved by below organisation

(FDI corp and Govt of India)

You go to shop he presents you a fire extinguisher verified by these organisations->(TMG corp).
You check if any of this is present in you "trust store".
No!!!! cant trust!!! you reject it.

But wait!!!!!

Shop keeper shows you another certificate Signed by Govt of India to TMG corp.
So what shop keeper is telling you is that I am giving you  2 certificates  

1.FGovt of India->TMG corp.
2.TMG corp

Now you can trust TMG corp because you trust Govt of India and he has given you additional
certificate issued by Govt of India to TMG corp.

or he could have provided you with 4 certificates
1. Govt of India to Intermediate entity 1
2.Intermediate entity 1 to intermediate entity 2
3.Intermediate entity 2 to TMG corp
4.TMG corp

and everything would have worked fine because Govt of India is in trust store
and certificate presents a chain of trust and since chain ultimately leads to Govt of India
so you trust all intermediates.

and communication is established.


Next question where does this certificate chain needs to be stored.
Obviously in server "keystore" so that it can be presented to client
and client can check if this chain eventually leads to "trusted entity" in "truststore"

Or when you login from your browser to yourbankaccount.com browser has "TRUSTSTORE" with trusted entities 
and yourbankaccount.com sends certificate chain to your browser.


